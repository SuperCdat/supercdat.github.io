<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <meta name="description" content="Paste Shield">

  <title>Paste Shield</title>
  <link rel="shortcut icon" href="../../assets/cdsuperat wuaze.svg" type="image/x-icon">
  <link rel="apple-touch-icon" href="../../assets/cdsuperat wuaze.svg" />
  <link rel="apple-touch-icon-precomposed" href="../../assets/cdsuperat wuaze.svg"/>

  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

  <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

</head>
<body id="body" class="body">
  <span class="material-symbols-outlined" style="font-size: 20px; position: fixed; left: 10px; top: 10px; padding: 5px 20px; border-radius: 500px; z-index: 2;" id="toggledarklight">
    routine
  </span>
  <span class="material-symbols-outlined" style="font-size: 20px; position: fixed; left: 75px; top: 10px; padding: 5px 20px; border-radius: 500px; z-index: 2;" id="togglebg">
    perm_media
  </span>
  <span class="material-symbols-outlined" style="font-size: 20px; position: fixed; right: 10px; top: 10px; padding: 5px 20px; border-radius: 500px; z-index: 2;" id="add">
    add
  </span>
  <div class="mainspace" id="mainspace">
    <div style="width: 100%; height: 60px; margin: 0 auto;"></div>
    <h1 id="nothingtoshow" style="margin-top: -60px; transform-origin: top;">Nothing To Show</h1>
  </div>

  <style>
    html {
      overflow: hidden;
    }
    body {
      -webkit-tap-highlight-color: transparent;
      color: black;
      background-color: white;
      transition: 0.1s ease-out;
      background-size: cover;
      background-attachment: fixed;
      display: flex;
      margin: 0 auto;
    }
    body.dark {
      color: white;
      background-color: black;
      transition: 0.1s ease-out;
    }
    .material-symbols-outlined {
      width: fit-content;
      height: fit-content;
      background-color: rgba(123, 213, 255, 0.3);
      backdrop-filter: blur(10px);
      user-select: none;
      transition: 0.1s ease-out;
      font-variation-settings:
      'FILL' 1,
      'wght' 400,
      'GRAD' 0,
      'opsz' 24
    }
    .material-symbols-outlined:active {
      background-color: rgba(76, 198, 255, 0.3);
    }
    body.dark .material-symbols-outlined {
      background-color: rgba(138, 180, 248, 0.3);
    }
    body.dark .material-symbols-outlined:active {
      background-color: rgba(96, 157, 255, 0.3);
    }

    #togglebg {
      font-variation-settings:
      'FILL' 0,
      'wght' 400,
      'GRAD' 0,
      'opsz' 24
    }
    #togglebg.enabled {
      font-variation-settings:
      'FILL' 1,
      'wght' 400,
      'GRAD' 0,
      'opsz' 24
    }

    body .mainspace {
      width: 100vw;
      /* border-radius: 10px; */
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      /* align-items: center; */
      flex: 1;
      scrollbar-width: thin;
      scrollbar-color: white transparent;

      gap: 10px;
      position: relative;
      overflow: auto;
      scroll-behavior: smooth;
      
      height: 100vh;
      /* background-color: rgba(0, 0, 0, 1); */
      /* background-color: rgba(0, 0, 0, 0.3); */

      /* backdrop-filter: blur(50px); */

      margin: 0 auto;
    }

    @keyframes fadein {
      from {opacity: 0; transform: scale(95%);}
      to {opacity: 1; transform: scale(100%);}
    }
    @keyframes fadeout {
      from {opacity: 1; transform: scale(100%);}
      to {opacity: 0; transform: scale(95%);}
    }

    body .mainspace .div {
      animation: fadein 0.1s ease-out;
      /* display: flex; */
      width: fit-content;
      height: fit-content;
      /* background-color: rgba(123, 213, 255, 1); */
      background-color: #e8eaed;
      /* backdrop-filter: blur(10px); */
      /* padding: 0 50px 0 0; */
      /* transform: translate(-100%, -100%); */
      border-radius: 10px;
      transition: background-color 0.2s ease-out;

    }
    body.dark .mainspace .div {
      /* background-color: rgba(138, 180, 248, 1); */
      /* background-color: rgba(0, 0, 0, 1); */
      background-color: #0F0F0F;
      transition: background-color 0.2s ease-out;
    }

    body .mainspace .div .padder textarea {
      transition: opacity 0.2s ease-out, border 0.2s ease-out, padding 0.2s ease-out, background-color 0.2s ease-out;
      margin: 0 auto;
      min-width: 100px;
      min-height: 100px;
      background-color: white;
      color: black;
      width: 190px;
      height: 190px;
      border-radius: 10px;
      padding: 10px;
      opacity: 1;
      scrollbar-width: thin;
      font-family: Consolas, Menlo, Monaco, Lucida Console, Liberation Mono, DejaVu Sans Mono, Bitstream Vera Sans Mono, Courier New, monospace, serif;
      scrollbar-color: black transparent;
      border: #e8eaed 1px solid;
    }
    body.dark .mainspace .div .padder textarea {
      background-color: #080a0e;
      color: white;
      scrollbar-color: white transparent;
      border: #767676 1px solid;
    }
    body .mainspace .div .padder textarea.collapsed {
      transition: opacity 0s, border 0.2s ease-out, padding 0.2s ease-out, background-color 0.2s ease-out;

      min-width: 0;
      min-height: 0;
      max-height: 0;
      padding: 0;
      border: 0;
      max-width: 0;
      opacity: 0;
      width: 0;
      height: 0;
    }

    body .mainspace .div .padder .actiondiv {
      width: 30px;
      height: 1;
      margin: 0 auto;
      display: flex;
      justify-content: start;
      /* flex-wrap: wrap; */
      font-size: 20px;
      overflow-x: auto;
      scrollbar-width: none;
      font-weight: 500;
      flex-direction: column;
      /* background-color: rgba(123, 213, 255, 0.8); */
      border-radius: 5px;
      -webkit-border-radius: 5px;
      -moz-border-radius: 5px;
      background-color: unset;
      font-family: Consolas, Menlo, Monaco, Lucida Console, Liberation Mono, DejaVu Sans Mono, Bitstream Vera Sans Mono, Courier New, monospace, serif;
      transition: color 0.2s ease-out;

    }
    /* body.dark .mainspace .div .actiondiv {
      background-color: rgba(138, 180, 248, 0.8);
    } */

    body .mainspace .div .padder {
      width: fit-content;
      height: fit-content;
      background-color: unset;
      display: flex;
      /* pointer-events: none; */
    }
    body .mainspace .div .makebigger {
      width: 100%;
      height: 100%;
      padding: 200px;
      pointer-events: none;
    }

    body .mainspace .div .padder .actiondiv .grab {
      width: 30px;
      height: fit-content;
      margin: 0 auto;
      padding-bottom: 4px;
      text-align: center;
      user-select: none;
      background-color: unset;
    }
    body .mainspace .div .padder .actiondiv .del {
      width: 30px;
      height: fit-content;
      margin: 0 auto;
      text-align: center;
      user-select: none;
      background-color: unset;
      padding-bottom: 4px;
    }

    body .mainspace .div .padder .actiondiv .save {
      width: 30px;
      height: fit-content;
      margin: 0 auto;
      text-align: center;
      user-select: none;
      background-color: unset;
      padding: 3px 0 0 0;
      font-variation-settings:
      'FILL' 0,
      'wght' 250,
      'GRAD' 0,
      'opsz' 24
    }

    body .mainspace .div .padder .actiondiv .expandcollapse {
      width: 27px;
      height: fit-content;
      margin: auto auto 2.5px auto;
      /* border-radius: 8.8px; */
      background-color: unset;
      text-align: center;
      user-select: none;
      backdrop-filter: none;
      background-color: unset;
      font-variation-settings:
      'FILL' 0,
      'wght' 350,
      'GRAD' 0,
      'opsz' 24
    }

  </style>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
    import { getDatabase , onChildAdded , onChildRemoved , ref , remove , update } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-database.js";


    const firebaseConfig = {
      apiKey: "AIzaSyAp_XPhktCmOo4OWYEwDFm4wxz36AU_w-E",
      authDomain: "neww-85685.firebaseapp.com",
      databaseURL: "https://neww-85685-default-rtdb.firebaseio.com",
      projectId: "neww-85685",
      storageBucket: "neww-85685.firebasestorage.app",
      messagingSenderId: "1092598028896",
      appId: "1:1092598028896:web:4eb807ea2c03c9eedd0105"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const dbRef = ref(db, "/WorkSpace/pasteshield")

    let gotShields = []
    onChildAdded(dbRef, (snapshot) => {
      if (!document.getElementById("mainspacediv-" + snapshot.key)) {
        if (document.getElementById("nothingtoshow")) {
            document.getElementById("nothingtoshow").parentNode.removeChild(document.getElementById("nothingtoshow"))
        }
        if (snapshot.val().ab) {
          if (!snapshot.val().ab.includes("deleted")) {
            addElement(snapshot.val().td, snapshot.val().ts, snapshot.val().aw, snapshot.val().ah, snapshot.val().dp, snapshot.val().dl, snapshot.val().dt, snapshot.val().ab, snapshot.key)
            gotShields.push(snapshot.key)
          }
        } else {
          addElement(snapshot.val().td, snapshot.val().ts, snapshot.val().aw, snapshot.val().ah, snapshot.val().dp, snapshot.val().dl, snapshot.val().dt, "", snapshot.key)
          gotShields.push(snapshot.key)

        }
      }
    })

    // let canremovelocally = true
    // onChildRemoved(dbRef, (snapshot) => {
    //   canremovelocally = false
    //   document.getElementById("mainspacediv-" + snapshot.key).style.animation = "fadeout 0.1s ease-out"
    //   setTimeout(() => {
    //     document.getElementById("mainspace").removeChild(document.getElementById("mainspacediv-" + snapshot.key))
    //     canremovelocally = true
    //   }, 100)
    // })

    document.getElementById("add").onclick = () => {
      addElement("", "15", 190, 190, "", "", "", "", Math.floor(Math.random() *1000000000).toString() + Math.floor(Math.random() *1000000000).toString() + Math.floor(Math.random() *1000000000).toString())
    }

    function addElement(textdata, textsize, areawidth, areaheight, divposition, divleft, divtop, ab, n) {

      let div = document.createElement("div")
      let padder = document.createElement("div")
      padder.classList.add("padder")
      let makebigger = document.createElement("div")
      makebigger.classList.add("makebigger")
      let textarea = document.createElement("textarea")
      textarea.name = "textarea-" + n
      textarea.value = textdata
      textarea.style.fontSize = textsize + "px"
      textarea.style.width = areawidth + "px"
      textarea.style.height = areaheight + "px"
      div.style.position = divposition
      let actiondiv = document.createElement("div")
      actiondiv.classList.add("actiondiv")
      let grab = document.createElement("p")
      grab.classList.add("grab")
      grab.innerHTML = "&#9776;"
      actiondiv.appendChild(grab)
      let del = document.createElement("p")
      if (!ab.includes("nod")) {
        del.classList.add("del")
        del.innerHTML = "&#128465;"
        actiondiv.appendChild(del)
      }
      let save = document.createElement("span")
      if (!ab.includes("ron")) {
        save.classList.add("save", "material-symbols-outlined")
        save.innerHTML = "save"
        actiondiv.appendChild(save)
      }
      let expandcollapse = document.createElement("span")
      expandcollapse.classList.add("expandcollapse")
      expandcollapse.classList.add("material-symbols-outlined")
      expandcollapse.innerHTML = "keyboard_arrow_up"
      actiondiv.appendChild(expandcollapse)
      padder.appendChild(textarea)
      padder.appendChild(actiondiv)
      div.appendChild(padder)
      div.draggable = false
      div.classList.add("div")
      div.id = "mainspacediv-" + n
      document.getElementById("mainspace").appendChild(div)


      function saving() {
        update(ref(db, "/WorkSpace/pasteshield/" + n), {
          "td" : textarea.value,
          "ts" : 15,
          "aw" : textarea.style.width.replace("px", ""),
          "ah" : textarea.style.height.replace("px", ""),
          "dp" : div.style.position,
          "dl" : div.style.left.replace("px", ""),
          "dt" : div.style.top.replace("px", ""),
          "time": new Date().toLocaleString(),
        })
      }

      textarea.addEventListener("keypress", (e) => {
        if (e.key == "=" && !ab.includes("ron")) {
          saving()
        }
      })
      save.addEventListener("click", () => {
        saving()
      })

      for (let i=0; i < document.getElementById("mainspace").children.length; i++) {
        document.getElementById("mainspace").children[i].style.zIndex = "0"
      }
      div.style.zIndex = 1

      let ismousedown = false
      let constnumX = 0
      let constnumY = 0
      
      div.addEventListener("mousedown", () => {
        if (div.style.zIndex != 1) {
          for (let i=0; i < document.getElementById("mainspace").children.length; i++) {
            document.getElementById("mainspace").children[i].style.zIndex = "0"
          }
          div.style.zIndex = 1

        }
      })

      grab.addEventListener("mousedown", (e) => {
        if (e.button == 2) {
          return
        }
        ismousedown = true
        constnumX = e.clientX - div.offsetLeft
        constnumY = e.clientY - div.offsetTop

      })

      document.addEventListener("mousemove", (e) => {
        if (ismousedown) {
          if (div.style.position != "absolute") {
            div.style.position = "absolute"
          }
          div.style.left = e.clientX - constnumX + "px"
          div.style.top = e.clientY - constnumY + "px"
        }
      })

      document.addEventListener("mouseup", (e) => {
        ismousedown = false
        constnumX = 0
        constnumY = 0



      
      })



      del.onclick = () => {
        // remove(ref(db, "/WorkSpace/pasteshield/" + n))

        if (gotShields.includes(n)) {
          update(ref(db, "/WorkSpace/pasteshield/" + n), {
            "ab": "deleted",
          })
        }
        div.style.setProperty("animation", "fadeout 0.1s ease-out")
        setTimeout(() => {
          document.getElementById("mainspace").removeChild(div)
        }, 90)

      }


      var expandcollapsing = true
      expandcollapse.addEventListener("click", () => {
        if (expandcollapsing) {
          textarea.classList.toggle("collapsed")
          expandcollapse.style.setProperty("margin", "3px auto auto auto")
          expandcollapse.style.removeProperty("background-color")
          actiondiv.style.setProperty("width", "fit-content")
          actiondiv.style.setProperty("flex-direction", "unset")
          expandcollapse.innerHTML = "keyboard_arrow_down"
          div.style.setProperty("border", "1px solid #767676")
          localStorage[n + " expandcollapse"] = "collapsed"
          expandcollapsing = false

        } else {
          textarea.classList.toggle("collapsed")
          textarea.style.setProperty.animation = "opacityin 0.2s ease-out"
          expandcollapse.style.setProperty("margin", "auto auto 2.5px auto")
          localStorage.removeItem(n + " expandcollapse")
          textarea.style.setProperty("display", "unset")
          expandcollapse.innerHTML = "keyboard_arrow_up"
          actiondiv.style.setProperty("width", "30px")
          actiondiv.style.setProperty("flex-direction", "column")
          div.style.setProperty("border", "0")
          expandcollapsing = true
        }
      })
      if (localStorage[div.id.replace("mainspacediv-", "") + " expandcollapse"]) {
        expandcollapse.click()
      }

      if (!expandcollapsing && localStorage[div.id.replace("mainspacediv-", "") + " divleft"] && localStorage[div.id.replace("mainspacediv-", "") + " divtop"]) {
        div.style.left = localStorage[div.id.replace("mainspacediv-", "") + " divleft"]
        div.style.top = localStorage[div.id.replace("mainspacediv-", "") + " divtop"]
      } else {
        div.style.left = divleft + "px"
        div.style.top = divtop + "px"
      }

    }

    $(document).mouseup(function(event) {
      let main
      try {
        main = (event.target).parentElement.parentElement.parentElement.getAttribute("id")
        localStorage[main.replace("mainspacediv-", "") + " divleft"] = document.getElementById(main).style.left
        localStorage[main.replace("mainspacediv-", "") + " divtop"] = document.getElementById(main).style.top
      } catch {
        return
      }

    })

  </script>
  <script>


    if (localStorage.togglebg && localStorage.togglebg == "enabled") {
      togglebgf()
    }

    function togglebgf() {
      let bg = ""
      let rand = Math.floor(Math.random() * 100)
      if (rand >= 90) {
        bg = "https://lh4.googleusercontent.com/proxy/cPoqHJjN8Gf-4A_2AHftnhXHxnLS_PJ87v6b2Joche0ro3M1ACPatbA0ex9A4QTxRz5r1yOKYSDkII8AUz4dqbpbO4zC-RuV8Y_URA=w3840-h2160-p-k-no-nd-mv"
      } else if (rand >= 80) {
        bg = "https://lh3.googleusercontent.com/proxy/3EnTIe8unY7R83kivrdseZAKyxWp0UOwzpJidrBwyDimvH2o6Lcta5e5Eo9ZC17Rto6Ks8vxRaTyQc3ESkAjFQPYbHr9RJn3LDzFf6UgiFKS=w3840-h2160-p-k-no-nd-mv"
      } else if (rand >= 70) {
        bg = "https://lh5.googleusercontent.com/proxy/qYqXRBouK-0WcQBlgrjmm2R71-uO1DY3ITc32Dmxbgx_AV6TNqEBpL7UjlpUi1o7iOJiRSX1jU2xTGtXhoqpzFGOkzlbLTHpaQCTOOGD3rrw=w3840-h2160-p-k-no-nd-mv"
      } else if (rand >= 60) {
        bg = "https://lh4.googleusercontent.com/proxy/J69LhCB9JgHZG6yCAnsM5e4inn4L_kCa9epp5md6mNX8aGd21AuNZRDyQ903w8c7uRMnvyW7IH_eW4sKjhXhmQDQHuDwyqo25L-v1znT4nkN=w3840-h2160-p-k-no-nd-mv"
      } else if (rand >= 50) {
        bg = "https://lh5.googleusercontent.com/proxy/lg0-JXcRcx2Hqxit-dxazm1oHumu5iHx2rP3_7cpbwoKLGJJ7Qejq1HEgPlEPw5rGt8wx9FNUzdXT90AJCYTFSYdLBQLUXhM5BPQTIpBxZVW=w3840-h2160-p-k-no-nd-mv"
      } else if (rand >= 40) {
        bg = "https://lh3.googleusercontent.com/proxy/wKevJtAnNVKsFWkn71WJHIb3wVdivO6HHn7gwCHpgjq3wTc09fLzLvEkWAURjzW_ijwmyPHL09rfJc1_A8nmgS5owUp2chfO4qu-1SeV_ZDl=w3840-h2160-p-k-no-nd-mv"
      } else if (rand >= 30) {
        bg = "https://lh3.googleusercontent.com/proxy/t6GTjmyF8HHqzPhiLHGHCjnF7wzwo7Jf4baWEM3x5EMKNb_4BYId9fEICUrGmd5SOxpcFuX4pAX3tRKppW9iwZbUqsMPc9NAMee5agamxGY=w3840-h2160-p-k-no-nd-mv"
      } else if (rand >= 20) {
        bg = "https://lh5.googleusercontent.com/proxy/Y7-G8pa5Wxp6DrI_5QZDXRCNlb7DgQBEcIV6PHWvKJpySzaOTFDaRNNRkcINHGFbHkEA5WxwIRVXrA7LX_Mp479UlkIg3fTWdw=w3840-h2160-p-k-no-nd-mv"
      } else if (rand >= 10) {
        bg = "https://lh6.googleusercontent.com/proxy/4IP40Q18w6aDF4oS4WRnUj0MlCCKPK-vLHqSd4r-RfS6JxgblG5WJuRYpkJkoTzLMS0qv3Sxhf9wdaKkn3vHnyy6oe7Ah5y0=w3840-h2160-p-k-no-nd-mv"
      } else {
        bg = "https://lh5.googleusercontent.com/proxy/I_e0wXf_YvalkQdK68RivaiJqrsuP4IJpA51R3weWVURNVGhSzcVsvX25OnbidscrwzCKomOw4SpfZ4HwwDz5YCTS1TWu7it6cUO4Y-EkTVM=w3840-h2160-p-k-no-nd-mv"
      }
      document.getElementById("body").style.backgroundImage = "url(" + bg + ")"

    }


    let togglebg = ""
    if (localStorage.togglebg == "enabled") {
      togglebg = localStorage.togglebg
      document.getElementById("togglebg").classList.add("enabled")
      } else {
      localStorage.togglebg = togglebg
    }
    document.getElementById("togglebg").onclick = () => {
      document.getElementById("togglebg").classList.toggle("enabled")

      if (togglebg == "enabled") {
        togglebg = "none"
        document.getElementById("body").style.backgroundImage = ""
        localStorage.togglebg = togglebg

      } else {
        togglebg = "enabled"
        togglebgf()
        localStorage.togglebg = togglebg

      }
    }

    if (localStorage.dark == "enabled") {
      document.getElementById("body").classList.toggle("dark")
    }
    document.getElementById("toggledarklight").onclick = () => {
      document.getElementById("body").classList.toggle("dark")
      if (localStorage.dark == "enabled") {
        localStorage.removeItem("dark")
      } else {
        localStorage.dark = "enabled"
      }
    }

    function autochangebg() {
      setTimeout(() => {
        if (localStorage.togglebg == "enabled") {
          togglebgf()
        }
      }, 60000)
    }
    autochangebg()

  </script>
</body>
</html>
